   1              		.syntax unified
   2              		.cpu cortex-m4
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 6
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.thumb
  14              		.file	"usb_bsp.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.USB_OTG_BSP_Init,"ax",%progbits
  19              		.align	2
  20              		.global	USB_OTG_BSP_Init
  21              		.thumb
  22              		.thumb_func
  24              	USB_OTG_BSP_Init:
  25              	.LFB110:
  26              		.file 1 "../src/usb_bsp.c"
   1:../src/usb_bsp.c **** /**
   2:../src/usb_bsp.c ****   ******************************************************************************
   3:../src/usb_bsp.c ****   * @file    usb_bsp.c
   4:../src/usb_bsp.c ****   * @author  MCD Application Team
   5:../src/usb_bsp.c ****   * @version V1.0.0
   6:../src/usb_bsp.c ****   * @date    19-September-2011
   7:../src/usb_bsp.c ****   * @brief   This file is responsible to offer board support package and is 
   8:../src/usb_bsp.c ****   *          configurable by user.
   9:../src/usb_bsp.c ****   ******************************************************************************
  10:../src/usb_bsp.c ****   * @attention
  11:../src/usb_bsp.c ****   *
  12:../src/usb_bsp.c ****   * THE PRESENT FIRMWARE WHICH IS FOR GUIDANCE ONLY AIMS AT PROVIDING CUSTOMERS
  13:../src/usb_bsp.c ****   * WITH CODING INFORMATION REGARDING THEIR PRODUCTS IN ORDER FOR THEM TO SAVE
  14:../src/usb_bsp.c ****   * TIME. AS A RESULT, STMICROELECTRONICS SHALL NOT BE HELD LIABLE FOR ANY
  15:../src/usb_bsp.c ****   * DIRECT, INDIRECT OR CONSEQUENTIAL DAMAGES WITH RESPECT TO ANY CLAIMS ARISING
  16:../src/usb_bsp.c ****   * FROM THE CONTENT OF SUCH FIRMWARE AND/OR THE USE MADE BY CUSTOMERS OF THE
  17:../src/usb_bsp.c ****   * CODING INFORMATION CONTAINED HEREIN IN CONNECTION WITH THEIR PRODUCTS. 
  18:../src/usb_bsp.c ****   *
  19:../src/usb_bsp.c ****   * <h2><center>&copy; COPYRIGHT 2011 STMicroelectronics</center></h2>
  20:../src/usb_bsp.c ****   ******************************************************************************
  21:../src/usb_bsp.c ****   */ 
  22:../src/usb_bsp.c **** 
  23:../src/usb_bsp.c **** /* Includes ------------------------------------------------------------------*/
  24:../src/usb_bsp.c **** #include "usb_bsp.h"
  25:../src/usb_bsp.c **** #include "usbd_conf.h"
  26:../src/usb_bsp.c **** #include "stm32f4_discovery.h"
  27:../src/usb_bsp.c **** 
  28:../src/usb_bsp.c **** /** @addtogroup STM32_USB_OTG_DEVICE_LIBRARY
  29:../src/usb_bsp.c **** * @{
  30:../src/usb_bsp.c **** */
  31:../src/usb_bsp.c **** 
  32:../src/usb_bsp.c **** /** @defgroup USB_BSP
  33:../src/usb_bsp.c **** * @brief This file is responsible to offer board support package
  34:../src/usb_bsp.c **** * @{
  35:../src/usb_bsp.c **** */ 
  36:../src/usb_bsp.c **** 
  37:../src/usb_bsp.c **** /** @defgroup USB_BSP_Private_Defines
  38:../src/usb_bsp.c **** * @{
  39:../src/usb_bsp.c **** */ 
  40:../src/usb_bsp.c **** /**
  41:../src/usb_bsp.c **** * @}
  42:../src/usb_bsp.c **** */ 
  43:../src/usb_bsp.c **** 
  44:../src/usb_bsp.c **** 
  45:../src/usb_bsp.c **** /** @defgroup USB_BSP_Private_TypesDefinitions
  46:../src/usb_bsp.c **** * @{
  47:../src/usb_bsp.c **** */ 
  48:../src/usb_bsp.c **** /**
  49:../src/usb_bsp.c **** * @}
  50:../src/usb_bsp.c **** */ 
  51:../src/usb_bsp.c **** 
  52:../src/usb_bsp.c **** 
  53:../src/usb_bsp.c **** 
  54:../src/usb_bsp.c **** 
  55:../src/usb_bsp.c **** 
  56:../src/usb_bsp.c **** /** @defgroup USB_BSP_Private_Macros
  57:../src/usb_bsp.c **** * @{
  58:../src/usb_bsp.c **** */ 
  59:../src/usb_bsp.c **** /**
  60:../src/usb_bsp.c **** * @}
  61:../src/usb_bsp.c **** */ 
  62:../src/usb_bsp.c **** 
  63:../src/usb_bsp.c **** /** @defgroup USBH_BSP_Private_Variables
  64:../src/usb_bsp.c **** * @{
  65:../src/usb_bsp.c **** */ 
  66:../src/usb_bsp.c **** 
  67:../src/usb_bsp.c **** /**
  68:../src/usb_bsp.c **** * @}
  69:../src/usb_bsp.c **** */ 
  70:../src/usb_bsp.c **** 
  71:../src/usb_bsp.c **** /** @defgroup USBH_BSP_Private_FunctionPrototypes
  72:../src/usb_bsp.c **** * @{
  73:../src/usb_bsp.c **** */ 
  74:../src/usb_bsp.c **** /**
  75:../src/usb_bsp.c **** * @}
  76:../src/usb_bsp.c **** */ 
  77:../src/usb_bsp.c **** 
  78:../src/usb_bsp.c **** /** @defgroup USB_BSP_Private_Functions
  79:../src/usb_bsp.c **** * @{
  80:../src/usb_bsp.c **** */ 
  81:../src/usb_bsp.c **** 
  82:../src/usb_bsp.c **** 
  83:../src/usb_bsp.c **** /**
  84:../src/usb_bsp.c **** * @brief  USB_OTG_BSP_Init
  85:../src/usb_bsp.c **** *         Initilizes BSP configurations
  86:../src/usb_bsp.c **** * @param  None
  87:../src/usb_bsp.c **** * @retval None
  88:../src/usb_bsp.c **** */
  89:../src/usb_bsp.c **** 
  90:../src/usb_bsp.c **** void USB_OTG_BSP_Init(USB_OTG_CORE_HANDLE *pdev)
  91:../src/usb_bsp.c **** {
  27              		.loc 1 91 0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 16
  30              		@ frame_needed = 1, uses_anonymous_args = 0
  31 0000 80B5     		push	{r7, lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 8
  34              		.cfi_offset 14, -4
  35              		.cfi_offset 7, -8
  36 0002 84B0     		sub	sp, sp, #16
  37              	.LCFI1:
  38              		.cfi_def_cfa_offset 24
  39 0004 00AF     		add	r7, sp, #0
  40              	.LCFI2:
  41              		.cfi_def_cfa_register 7
  42 0006 7860     		str	r0, [r7, #4]
  92:../src/usb_bsp.c ****   GPIO_InitTypeDef GPIO_InitStructure;
  93:../src/usb_bsp.c **** 
  94:../src/usb_bsp.c **** #ifndef USE_ULPI_PHY 
  95:../src/usb_bsp.c **** #ifdef USB_OTG_FS_LOW_PWR_MGMT_SUPPORT
  96:../src/usb_bsp.c ****   EXTI_InitTypeDef EXTI_InitStructure;
  97:../src/usb_bsp.c ****   NVIC_InitTypeDef NVIC_InitStructure; 
  98:../src/usb_bsp.c **** #endif  
  99:../src/usb_bsp.c **** #endif
 100:../src/usb_bsp.c ****   
 101:../src/usb_bsp.c ****  
 102:../src/usb_bsp.c ****  #ifdef USE_USB_OTG_FS 
 103:../src/usb_bsp.c **** 
 104:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOA , ENABLE);  
  43              		.loc 1 104 0
  44 0008 4FF00100 		mov	r0, #1
  45 000c 4FF00101 		mov	r1, #1
  46 0010 FFF7FEFF 		bl	RCC_AHB1PeriphClockCmd
 105:../src/usb_bsp.c ****   
 106:../src/usb_bsp.c ****   /* Configure SOF VBUS ID DM DP Pins */
 107:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_8  | 
  47              		.loc 1 107 0
  48 0014 4FF4D853 		mov	r3, #6912
  49 0018 BB60     		str	r3, [r7, #8]
 108:../src/usb_bsp.c ****     GPIO_Pin_9  | 
 109:../src/usb_bsp.c ****       GPIO_Pin_11 | 
 110:../src/usb_bsp.c ****         GPIO_Pin_12;
 111:../src/usb_bsp.c ****   
 112:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
  50              		.loc 1 112 0
  51 001a 4FF00303 		mov	r3, #3
  52 001e 7B73     		strb	r3, [r7, #13]
 113:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
  53              		.loc 1 113 0
  54 0020 4FF00203 		mov	r3, #2
  55 0024 3B73     		strb	r3, [r7, #12]
 114:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
  56              		.loc 1 114 0
  57 0026 4FF00003 		mov	r3, #0
  58 002a BB73     		strb	r3, [r7, #14]
 115:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
  59              		.loc 1 115 0
  60 002c 4FF00003 		mov	r3, #0
  61 0030 FB73     		strb	r3, [r7, #15]
 116:../src/usb_bsp.c ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
  62              		.loc 1 116 0
  63 0032 4FF00000 		mov	r0, #0
  64 0036 C4F20200 		movt	r0, 16386
  65 003a 07F10803 		add	r3, r7, #8
  66 003e 1946     		mov	r1, r3
  67 0040 FFF7FEFF 		bl	GPIO_Init
 117:../src/usb_bsp.c ****   
 118:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource8,GPIO_AF_OTG1_FS) ;
  68              		.loc 1 118 0
  69 0044 4FF00000 		mov	r0, #0
  70 0048 C4F20200 		movt	r0, 16386
  71 004c 4FF00801 		mov	r1, #8
  72 0050 4FF00A02 		mov	r2, #10
  73 0054 FFF7FEFF 		bl	GPIO_PinAFConfig
 119:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource9,GPIO_AF_OTG1_FS) ; 
  74              		.loc 1 119 0
  75 0058 4FF00000 		mov	r0, #0
  76 005c C4F20200 		movt	r0, 16386
  77 0060 4FF00901 		mov	r1, #9
  78 0064 4FF00A02 		mov	r2, #10
  79 0068 FFF7FEFF 		bl	GPIO_PinAFConfig
 120:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource11,GPIO_AF_OTG1_FS) ; 
  80              		.loc 1 120 0
  81 006c 4FF00000 		mov	r0, #0
  82 0070 C4F20200 		movt	r0, 16386
  83 0074 4FF00B01 		mov	r1, #11
  84 0078 4FF00A02 		mov	r2, #10
  85 007c FFF7FEFF 		bl	GPIO_PinAFConfig
 121:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource12,GPIO_AF_OTG1_FS) ;
  86              		.loc 1 121 0
  87 0080 4FF00000 		mov	r0, #0
  88 0084 C4F20200 		movt	r0, 16386
  89 0088 4FF00C01 		mov	r1, #12
  90 008c 4FF00A02 		mov	r2, #10
  91 0090 FFF7FEFF 		bl	GPIO_PinAFConfig
 122:../src/usb_bsp.c ****   
 123:../src/usb_bsp.c ****   /* this for ID line debug */
 124:../src/usb_bsp.c ****   
 125:../src/usb_bsp.c ****   
 126:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin =  GPIO_Pin_10;
  92              		.loc 1 126 0
  93 0094 4FF48063 		mov	r3, #1024
  94 0098 BB60     		str	r3, [r7, #8]
 127:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_OD;
  95              		.loc 1 127 0
  96 009a 4FF00103 		mov	r3, #1
  97 009e BB73     		strb	r3, [r7, #14]
 128:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_UP ;  
  98              		.loc 1 128 0
  99 00a0 4FF00103 		mov	r3, #1
 100 00a4 FB73     		strb	r3, [r7, #15]
 129:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 101              		.loc 1 129 0
 102 00a6 4FF00303 		mov	r3, #3
 103 00aa 7B73     		strb	r3, [r7, #13]
 130:../src/usb_bsp.c ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 104              		.loc 1 130 0
 105 00ac 4FF00000 		mov	r0, #0
 106 00b0 C4F20200 		movt	r0, 16386
 107 00b4 07F10803 		add	r3, r7, #8
 108 00b8 1946     		mov	r1, r3
 109 00ba FFF7FEFF 		bl	GPIO_Init
 131:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource10,GPIO_AF_OTG1_FS) ;   
 110              		.loc 1 131 0
 111 00be 4FF00000 		mov	r0, #0
 112 00c2 C4F20200 		movt	r0, 16386
 113 00c6 4FF00A01 		mov	r1, #10
 114 00ca 4FF00A02 		mov	r2, #10
 115 00ce FFF7FEFF 		bl	GPIO_PinAFConfig
 132:../src/usb_bsp.c **** 
 133:../src/usb_bsp.c ****   RCC_APB2PeriphClockCmd(RCC_APB2Periph_SYSCFG, ENABLE);
 116              		.loc 1 133 0
 117 00d2 4FF48040 		mov	r0, #16384
 118 00d6 4FF00101 		mov	r1, #1
 119 00da FFF7FEFF 		bl	RCC_APB2PeriphClockCmd
 134:../src/usb_bsp.c ****   RCC_AHB2PeriphClockCmd(RCC_AHB2Periph_OTG_FS, ENABLE) ; 
 120              		.loc 1 134 0
 121 00de 4FF08000 		mov	r0, #128
 122 00e2 4FF00101 		mov	r1, #1
 123 00e6 FFF7FEFF 		bl	RCC_AHB2PeriphClockCmd
 135:../src/usb_bsp.c ****  #else // USE_USB_OTG_HS 
 136:../src/usb_bsp.c **** 
 137:../src/usb_bsp.c ****   #ifdef USE_ULPI_PHY // ULPI
 138:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOA | RCC_AHB1Periph_GPIOB | 
 139:../src/usb_bsp.c ****                          RCC_AHB1Periph_GPIOC | RCC_AHB1Periph_GPIOH | 
 140:../src/usb_bsp.c ****                            RCC_AHB1Periph_GPIOI, ENABLE);    
 141:../src/usb_bsp.c ****   
 142:../src/usb_bsp.c ****   
 143:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource3, GPIO_AF_OTG2_HS) ; // D0
 144:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOA,GPIO_PinSource5, GPIO_AF_OTG2_HS) ; // CLK
 145:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource0, GPIO_AF_OTG2_HS) ; // D1
 146:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource1, GPIO_AF_OTG2_HS) ; // D2
 147:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource5, GPIO_AF_OTG2_HS) ; // D7
 148:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource10,GPIO_AF_OTG2_HS) ; // D3
 149:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource11,GPIO_AF_OTG2_HS) ; // D4
 150:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource12,GPIO_AF_OTG2_HS) ; // D5
 151:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource13,GPIO_AF_OTG2_HS) ; // D6
 152:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOH,GPIO_PinSource4, GPIO_AF_OTG2_HS) ; // NXT
 153:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOI,GPIO_PinSource11,GPIO_AF_OTG2_HS) ; // DIR
 154:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOC,GPIO_PinSource0, GPIO_AF_OTG2_HS) ; // STP
 155:../src/usb_bsp.c ****   
 156:../src/usb_bsp.c ****   // CLK
 157:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_5 ; 
 158:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 159:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 160:../src/usb_bsp.c ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 161:../src/usb_bsp.c ****   
 162:../src/usb_bsp.c ****   // D0
 163:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_3  ; 
 164:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 165:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 166:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 167:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
 168:../src/usb_bsp.c ****   GPIO_Init(GPIOA, &GPIO_InitStructure);  
 169:../src/usb_bsp.c ****   
 170:../src/usb_bsp.c ****   
 171:../src/usb_bsp.c ****   
 172:../src/usb_bsp.c ****   // D1 D2 D3 D4 D5 D6 D7
 173:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | GPIO_Pin_1  |
 174:../src/usb_bsp.c ****     GPIO_Pin_5 | GPIO_Pin_10 | 
 175:../src/usb_bsp.c ****       GPIO_Pin_11| GPIO_Pin_12 | 
 176:../src/usb_bsp.c ****         GPIO_Pin_13 ;
 177:../src/usb_bsp.c ****   
 178:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 179:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 180:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_OType = GPIO_OType_PP;
 181:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_PuPd = GPIO_PuPd_NOPULL ;
 182:../src/usb_bsp.c ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 183:../src/usb_bsp.c ****   
 184:../src/usb_bsp.c ****   
 185:../src/usb_bsp.c ****   // STP
 186:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0  ;
 187:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 188:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 189:../src/usb_bsp.c ****   GPIO_Init(GPIOC, &GPIO_InitStructure);  
 190:../src/usb_bsp.c ****   
 191:../src/usb_bsp.c ****   //NXT  
 192:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_4;
 193:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 194:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 195:../src/usb_bsp.c ****   GPIO_Init(GPIOH, &GPIO_InitStructure);  
 196:../src/usb_bsp.c ****   
 197:../src/usb_bsp.c ****   
 198:../src/usb_bsp.c ****   //DIR
 199:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_11 ; 
 200:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 201:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 202:../src/usb_bsp.c ****   GPIO_Init(GPIOI, &GPIO_InitStructure);  
 203:../src/usb_bsp.c ****   
 204:../src/usb_bsp.c ****   
 205:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS | 
 206:../src/usb_bsp.c ****                          RCC_AHB1Periph_OTG_HS_ULPI, ENABLE) ;    
 207:../src/usb_bsp.c ****    
 208:../src/usb_bsp.c ****   #else
 209:../src/usb_bsp.c ****    #ifdef USE_I2C_PHY    
 210:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_GPIOB , ENABLE);  
 211:../src/usb_bsp.c ****   /* Configure RESET INTN SCL SDA (Phy/I2C) Pins */
 212:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_0 | 
 213:../src/usb_bsp.c ****     GPIO_Pin_1 | 
 214:../src/usb_bsp.c ****       GPIO_Pin_10 | 
 215:../src/usb_bsp.c ****         GPIO_Pin_11;
 216:../src/usb_bsp.c ****   
 217:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 218:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 219:../src/usb_bsp.c ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 220:../src/usb_bsp.c ****   
 221:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource0,GPIO_AF_OTG2_FS) ; 
 222:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource1,GPIO_AF_OTG2_FS) ; 
 223:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource10,GPIO_AF_OTG2_FS) ; 
 224:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource11,GPIO_AF_OTG2_FS);
 225:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS, ENABLE) ;  
 226:../src/usb_bsp.c ****   
 227:../src/usb_bsp.c ****    #else
 228:../src/usb_bsp.c **** 
 229:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd(RCC_AHB1Periph_GPIOB , ENABLE);
 230:../src/usb_bsp.c ****   
 231:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Pin = GPIO_Pin_12  | 
 232:../src/usb_bsp.c ****     GPIO_Pin_13 |
 233:../src/usb_bsp.c ****       GPIO_Pin_14 | 
 234:../src/usb_bsp.c ****         GPIO_Pin_15;
 235:../src/usb_bsp.c ****   
 236:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Speed = GPIO_Speed_100MHz;
 237:../src/usb_bsp.c ****   GPIO_InitStructure.GPIO_Mode = GPIO_Mode_AF;
 238:../src/usb_bsp.c ****   GPIO_Init(GPIOB, &GPIO_InitStructure);  
 239:../src/usb_bsp.c ****   
 240:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource12, GPIO_AF_OTG2_FS) ; 
 241:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource13,GPIO_AF_OTG2_FS) ; 
 242:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource14,GPIO_AF_OTG2_FS) ; 
 243:../src/usb_bsp.c ****   GPIO_PinAFConfig(GPIOB,GPIO_PinSource15,GPIO_AF_OTG2_FS) ;
 244:../src/usb_bsp.c ****   RCC_AHB1PeriphClockCmd( RCC_AHB1Periph_OTG_HS, ENABLE) ;  
 245:../src/usb_bsp.c ****    #endif  
 246:../src/usb_bsp.c ****   #endif // USE_ULPI_PHY
 247:../src/usb_bsp.c ****   
 248:../src/usb_bsp.c ****  #endif //USB_OTG_HS
 249:../src/usb_bsp.c **** 
 250:../src/usb_bsp.c ****   
 251:../src/usb_bsp.c ****   /* enable the PWR clock */
 252:../src/usb_bsp.c ****   RCC_APB1PeriphResetCmd(RCC_APB1Periph_PWR, ENABLE);   
 124              		.loc 1 252 0
 125 00ea 4FF08050 		mov	r0, #268435456
 126 00ee 4FF00101 		mov	r1, #1
 127 00f2 FFF7FEFF 		bl	RCC_APB1PeriphResetCmd
 253:../src/usb_bsp.c ****   
 254:../src/usb_bsp.c ****   /* Configure the Key button in EXTI mode */
 255:../src/usb_bsp.c ****   STM_EVAL_PBInit(BUTTON_USER, BUTTON_MODE_EXTI);
 128              		.loc 1 255 0
 129 00f6 4FF00000 		mov	r0, #0
 130 00fa 4FF00101 		mov	r1, #1
 131 00fe FFF7FEFF 		bl	STM_EVAL_PBInit
 256:../src/usb_bsp.c ****   
 257:../src/usb_bsp.c **** #ifdef USB_OTG_FS_LOW_PWR_MGMT_SUPPORT
 258:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line18);
 259:../src/usb_bsp.c ****   
 260:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Line = EXTI_Line18; 
 261:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;
 262:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;
 263:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_LineCmd = ENABLE;
 264:../src/usb_bsp.c ****   EXTI_Init(&EXTI_InitStructure);
 265:../src/usb_bsp.c **** 
 266:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line18);   
 267:../src/usb_bsp.c **** 
 268:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_FS_WKUP_IRQn;
 269:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 0;
 270:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 0;
 271:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 272:../src/usb_bsp.c ****   NVIC_Init(&NVIC_InitStructure);
 273:../src/usb_bsp.c **** 
 274:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line18);    
 275:../src/usb_bsp.c **** #endif 
 276:../src/usb_bsp.c ****   
 277:../src/usb_bsp.c **** #ifdef USB_OTG_HS_LOW_PWR_MGMT_SUPPORT
 278:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line20);
 279:../src/usb_bsp.c ****   
 280:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Line = EXTI_Line20; 
 281:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Mode = EXTI_Mode_Interrupt;
 282:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_Trigger = EXTI_Trigger_Rising;
 283:../src/usb_bsp.c ****   EXTI_InitStructure.EXTI_LineCmd = ENABLE;
 284:../src/usb_bsp.c ****   EXTI_Init(&EXTI_InitStructure);
 285:../src/usb_bsp.c **** 
 286:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line20);   
 287:../src/usb_bsp.c **** 
 288:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_WKUP_IRQn;
 289:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 2;
 290:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 2;
 291:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 292:../src/usb_bsp.c ****   NVIC_Init(&NVIC_InitStructure);
 293:../src/usb_bsp.c **** 
 294:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(EXTI_Line20);    
 295:../src/usb_bsp.c **** #endif   
 296:../src/usb_bsp.c **** 
 297:../src/usb_bsp.c ****   EXTI_ClearITPendingBit(USER_BUTTON_EXTI_LINE);  
 132              		.loc 1 297 0
 133 0102 4FF00100 		mov	r0, #1
 134 0106 FFF7FEFF 		bl	EXTI_ClearITPendingBit
 298:../src/usb_bsp.c **** }
 135              		.loc 1 298 0
 136 010a 07F11007 		add	r7, r7, #16
 137 010e BD46     		mov	sp, r7
 138 0110 80BD     		pop	{r7, pc}
 139              		.cfi_endproc
 140              	.LFE110:
 142 0112 00BF     		.section	.text.USB_OTG_BSP_EnableInterrupt,"ax",%progbits
 143              		.align	2
 144              		.global	USB_OTG_BSP_EnableInterrupt
 145              		.thumb
 146              		.thumb_func
 148              	USB_OTG_BSP_EnableInterrupt:
 149              	.LFB111:
 299:../src/usb_bsp.c **** /**
 300:../src/usb_bsp.c **** * @brief  USB_OTG_BSP_EnableInterrupt
 301:../src/usb_bsp.c **** *         Enabele USB Global interrupt
 302:../src/usb_bsp.c **** * @param  None
 303:../src/usb_bsp.c **** * @retval None
 304:../src/usb_bsp.c **** */
 305:../src/usb_bsp.c **** void USB_OTG_BSP_EnableInterrupt(USB_OTG_CORE_HANDLE *pdev)
 306:../src/usb_bsp.c **** {
 150              		.loc 1 306 0
 151              		.cfi_startproc
 152              		@ args = 0, pretend = 0, frame = 16
 153              		@ frame_needed = 1, uses_anonymous_args = 0
 154 0000 80B5     		push	{r7, lr}
 155              	.LCFI3:
 156              		.cfi_def_cfa_offset 8
 157              		.cfi_offset 14, -4
 158              		.cfi_offset 7, -8
 159 0002 84B0     		sub	sp, sp, #16
 160              	.LCFI4:
 161              		.cfi_def_cfa_offset 24
 162 0004 00AF     		add	r7, sp, #0
 163              	.LCFI5:
 164              		.cfi_def_cfa_register 7
 165 0006 7860     		str	r0, [r7, #4]
 307:../src/usb_bsp.c ****   NVIC_InitTypeDef NVIC_InitStructure; 
 308:../src/usb_bsp.c ****   
 309:../src/usb_bsp.c ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 166              		.loc 1 309 0
 167 0008 4FF4C060 		mov	r0, #1536
 168 000c FFF7FEFF 		bl	NVIC_PriorityGroupConfig
 310:../src/usb_bsp.c **** #ifdef USE_USB_OTG_HS   
 311:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_IRQn;
 312:../src/usb_bsp.c **** #else
 313:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_FS_IRQn;  
 169              		.loc 1 313 0
 170 0010 4FF04303 		mov	r3, #67
 171 0014 3B73     		strb	r3, [r7, #12]
 314:../src/usb_bsp.c **** #endif
 315:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 172              		.loc 1 315 0
 173 0016 4FF00103 		mov	r3, #1
 174 001a 7B73     		strb	r3, [r7, #13]
 316:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 3;
 175              		.loc 1 316 0
 176 001c 4FF00303 		mov	r3, #3
 177 0020 BB73     		strb	r3, [r7, #14]
 317:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 178              		.loc 1 317 0
 179 0022 4FF00103 		mov	r3, #1
 180 0026 FB73     		strb	r3, [r7, #15]
 318:../src/usb_bsp.c ****   NVIC_Init(&NVIC_InitStructure);  
 181              		.loc 1 318 0
 182 0028 07F10C03 		add	r3, r7, #12
 183 002c 1846     		mov	r0, r3
 184 002e FFF7FEFF 		bl	NVIC_Init
 319:../src/usb_bsp.c **** #ifdef USB_OTG_HS_DEDICATED_EP1_ENABLED
 320:../src/usb_bsp.c ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 321:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_EP1_OUT_IRQn;
 322:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 323:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 2;
 324:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 325:../src/usb_bsp.c ****   NVIC_Init(&NVIC_InitStructure);  
 326:../src/usb_bsp.c ****   
 327:../src/usb_bsp.c ****   NVIC_PriorityGroupConfig(NVIC_PriorityGroup_1);
 328:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannel = OTG_HS_EP1_IN_IRQn;
 329:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelPreemptionPriority = 1;
 330:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelSubPriority = 1;
 331:../src/usb_bsp.c ****   NVIC_InitStructure.NVIC_IRQChannelCmd = ENABLE;
 332:../src/usb_bsp.c ****   NVIC_Init(&NVIC_InitStructure);   
 333:../src/usb_bsp.c **** #endif
 334:../src/usb_bsp.c **** }
 185              		.loc 1 334 0
 186 0032 07F11007 		add	r7, r7, #16
 187 0036 BD46     		mov	sp, r7
 188 0038 80BD     		pop	{r7, pc}
 189              		.cfi_endproc
 190              	.LFE111:
 192 003a 00BF     		.section	.text.USB_OTG_BSP_uDelay,"ax",%progbits
 193              		.align	2
 194              		.global	USB_OTG_BSP_uDelay
 195              		.thumb
 196              		.thumb_func
 198              	USB_OTG_BSP_uDelay:
 199              	.LFB112:
 335:../src/usb_bsp.c **** /**
 336:../src/usb_bsp.c **** * @brief  USB_OTG_BSP_uDelay
 337:../src/usb_bsp.c **** *         This function provides delay time in micro sec
 338:../src/usb_bsp.c **** * @param  usec : Value of delay required in micro sec
 339:../src/usb_bsp.c **** * @retval None
 340:../src/usb_bsp.c **** */
 341:../src/usb_bsp.c **** void USB_OTG_BSP_uDelay (const uint32_t usec)
 342:../src/usb_bsp.c **** {
 200              		.loc 1 342 0
 201              		.cfi_startproc
 202              		@ args = 0, pretend = 0, frame = 16
 203              		@ frame_needed = 1, uses_anonymous_args = 0
 204              		@ link register save eliminated.
 205 0000 80B4     		push	{r7}
 206              	.LCFI6:
 207              		.cfi_def_cfa_offset 4
 208              		.cfi_offset 7, -4
 209 0002 85B0     		sub	sp, sp, #20
 210              	.LCFI7:
 211              		.cfi_def_cfa_offset 24
 212 0004 00AF     		add	r7, sp, #0
 213              	.LCFI8:
 214              		.cfi_def_cfa_register 7
 215 0006 7860     		str	r0, [r7, #4]
 343:../src/usb_bsp.c ****   uint32_t count = 0;
 216              		.loc 1 343 0
 217 0008 4FF00003 		mov	r3, #0
 218 000c FB60     		str	r3, [r7, #12]
 344:../src/usb_bsp.c ****   const uint32_t utime = (120 * usec / 7);
 219              		.loc 1 344 0
 220 000e 7A68     		ldr	r2, [r7, #4]
 221 0010 1346     		mov	r3, r2
 222 0012 4FEA0313 		lsl	r3, r3, #4
 223 0016 9B1A     		subs	r3, r3, r2
 224 0018 4FEAC303 		lsl	r3, r3, #3
 225 001c 1A46     		mov	r2, r3
 226 001e 44F62513 		movw	r3, #18725
 227 0022 C2F29243 		movt	r3, 9362
 228 0026 A3FB0213 		umull	r1, r3, r3, r2
 229 002a D21A     		subs	r2, r2, r3
 230 002c 4FEA5202 		lsr	r2, r2, #1
 231 0030 9B18     		adds	r3, r3, r2
 232 0032 4FEA9303 		lsr	r3, r3, #2
 233 0036 BB60     		str	r3, [r7, #8]
 234 0038 00E0     		b	.L5
 235              	.L6:
 345:../src/usb_bsp.c ****   do
 346:../src/usb_bsp.c ****   {
 347:../src/usb_bsp.c ****     if ( ++count > utime )
 348:../src/usb_bsp.c ****     {
 349:../src/usb_bsp.c ****       return ;
 350:../src/usb_bsp.c ****     }
 351:../src/usb_bsp.c ****   }
 352:../src/usb_bsp.c ****   while (1);
 236              		.loc 1 352 0
 237 003a 00BF     		nop
 238              	.L5:
 347:../src/usb_bsp.c ****     if ( ++count > utime )
 239              		.loc 1 347 0
 240 003c FB68     		ldr	r3, [r7, #12]
 241 003e 03F10103 		add	r3, r3, #1
 242 0042 FB60     		str	r3, [r7, #12]
 243 0044 FA68     		ldr	r2, [r7, #12]
 244 0046 BB68     		ldr	r3, [r7, #8]
 245 0048 9A42     		cmp	r2, r3
 246 004a F6D9     		bls	.L6
 349:../src/usb_bsp.c ****       return ;
 247              		.loc 1 349 0
 248 004c 00BF     		nop
 353:../src/usb_bsp.c **** }
 249              		.loc 1 353 0
 250 004e 07F11407 		add	r7, r7, #20
 251 0052 BD46     		mov	sp, r7
 252 0054 80BC     		pop	{r7}
 253 0056 7047     		bx	lr
 254              		.cfi_endproc
 255              	.LFE112:
 257              		.section	.text.USB_OTG_BSP_mDelay,"ax",%progbits
 258              		.align	2
 259              		.global	USB_OTG_BSP_mDelay
 260              		.thumb
 261              		.thumb_func
 263              	USB_OTG_BSP_mDelay:
 264              	.LFB113:
 354:../src/usb_bsp.c **** 
 355:../src/usb_bsp.c **** 
 356:../src/usb_bsp.c **** /**
 357:../src/usb_bsp.c **** * @brief  USB_OTG_BSP_mDelay
 358:../src/usb_bsp.c **** *          This function provides delay time in milli sec
 359:../src/usb_bsp.c **** * @param  msec : Value of delay required in milli sec
 360:../src/usb_bsp.c **** * @retval None
 361:../src/usb_bsp.c **** */
 362:../src/usb_bsp.c **** void USB_OTG_BSP_mDelay (const uint32_t msec)
 363:../src/usb_bsp.c **** {
 265              		.loc 1 363 0
 266              		.cfi_startproc
 267              		@ args = 0, pretend = 0, frame = 8
 268              		@ frame_needed = 1, uses_anonymous_args = 0
 269 0000 80B5     		push	{r7, lr}
 270              	.LCFI9:
 271              		.cfi_def_cfa_offset 8
 272              		.cfi_offset 14, -4
 273              		.cfi_offset 7, -8
 274 0002 82B0     		sub	sp, sp, #8
 275              	.LCFI10:
 276              		.cfi_def_cfa_offset 16
 277 0004 00AF     		add	r7, sp, #0
 278              	.LCFI11:
 279              		.cfi_def_cfa_register 7
 280 0006 7860     		str	r0, [r7, #4]
 364:../src/usb_bsp.c ****   USB_OTG_BSP_uDelay(msec * 1000);   
 281              		.loc 1 364 0
 282 0008 7B68     		ldr	r3, [r7, #4]
 283 000a 4FF47A72 		mov	r2, #1000
 284 000e 02FB03F3 		mul	r3, r2, r3
 285 0012 1846     		mov	r0, r3
 286 0014 FFF7FEFF 		bl	USB_OTG_BSP_uDelay
 365:../src/usb_bsp.c **** }
 287              		.loc 1 365 0
 288 0018 07F10807 		add	r7, r7, #8
 289 001c BD46     		mov	sp, r7
 290 001e 80BD     		pop	{r7, pc}
 291              		.cfi_endproc
 292              	.LFE113:
 294              		.text
 295              	.Letext0:
 296              		.file 2 "c:\\program files (x86)\\codesourcery\\sourcery_codebench_lite_for_arm_eabi\\bin\\../lib/
 297              		.file 3 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\CMSIS\\ST\\
 298              		.file 4 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\STM32F4xx_S
 299              		.file 5 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\STM32F4xx_S
 300              		.file 6 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\STM32_USB_O
 301              		.file 7 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\STM32_USB_O
 302              		.file 8 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Utilities\\STM32F4-Dis
 303              		.file 9 "C:\\Users\\Anthony.Paterson@opus.co\\Documents\\git\\blink\\blink\\Libraries\\CMSIS\\Incl
DEFINED SYMBOLS
                            *ABS*:00000000 usb_bsp.c
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:19     .text.USB_OTG_BSP_Init:00000000 $t
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:24     .text.USB_OTG_BSP_Init:00000000 USB_OTG_BSP_Init
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:143    .text.USB_OTG_BSP_EnableInterrupt:00000000 $t
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:148    .text.USB_OTG_BSP_EnableInterrupt:00000000 USB_OTG_BSP_EnableInterrupt
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:193    .text.USB_OTG_BSP_uDelay:00000000 $t
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:198    .text.USB_OTG_BSP_uDelay:00000000 USB_OTG_BSP_uDelay
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:258    .text.USB_OTG_BSP_mDelay:00000000 $t
C:\Users\ANTHON~1.CO\AppData\Local\Temp\ccgF8Em0.s:263    .text.USB_OTG_BSP_mDelay:00000000 USB_OTG_BSP_mDelay
                     .debug_frame:00000010 $d

UNDEFINED SYMBOLS
RCC_AHB1PeriphClockCmd
GPIO_Init
GPIO_PinAFConfig
RCC_APB2PeriphClockCmd
RCC_AHB2PeriphClockCmd
RCC_APB1PeriphResetCmd
STM_EVAL_PBInit
EXTI_ClearITPendingBit
NVIC_PriorityGroupConfig
NVIC_Init
